import{y as O,z as k,A as F,B as P,C as L,_ as M,i as h,j as D,c as S,a as A,d as f,w as v,s as G,F as U,b as j,D as z,H as K,I as B,J as R,K as $,o as y,e as I,t as H,f as q,G as J,L as Y,M as Q}from"./index-6mvJwAeU.js";const V=e=>{let t=0,o=e;for(;o;)t+=o.offsetTop,o=o.offsetParent;return t},W=(e,t)=>Math.abs(V(e)-V(t)),c="ElInfiniteScroll",X=50,Z=200,ee=0,te={delay:{type:Number,default:Z},distance:{type:Number,default:ee},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},C=(e,t)=>Object.entries(te).reduce((o,[s,l])=>{var r,a;const{type:d,default:i}=l,u=e.getAttribute(`infinite-scroll-${s}`);let n=(a=(r=t[u])!=null?r:u)!=null?a:i;return n=n==="false"?!1:n,n=d(n),o[s]=Number.isNaN(n)?i:n,o},{}),x=e=>{const{observer:t}=e[c];t&&(t.disconnect(),delete e[c].observer)},oe=(e,t)=>{const{container:o,containerEl:s,instance:l,observer:r,lastScrollTop:a}=e[c],{disabled:d,distance:i}=C(e,l),{clientHeight:u,scrollHeight:n,scrollTop:b}=s,_=b-a;if(e[c].lastScrollTop=b,r||d||_<0)return;let m=!1;if(o===e)m=n-(u+b)<=i;else{const{clientTop:p,scrollHeight:E}=e,T=W(e,s);m=b+u>=T+p+E-i}m&&t.call(l)};function w(e,t){const{containerEl:o,instance:s}=e[c],{disabled:l}=C(e,s);l||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?t.call(s):x(e))}const se={async mounted(e,t){const{instance:o,value:s}=t;O(s)||k(c,"'v-infinite-scroll' binding value must be a function"),await F();const{delay:l,immediate:r}=C(e,o),a=P(e,!0),d=a===window?document.documentElement:a,i=L(oe.bind(null,e,s),l);if(a){if(e[c]={instance:o,container:a,containerEl:d,delay:l,cb:s,onScroll:i,lastScrollTop:d.scrollTop},r){const u=new MutationObserver(L(w.bind(null,e,s),X));e[c].observer=u,u.observe(e,{childList:!0,subtree:!0}),w(e,s)}a.addEventListener("scroll",i)}},unmounted(e){const{container:t,onScroll:o}=e[c];t==null||t.removeEventListener("scroll",o),x(e)},async updated(e){if(!e[c])await F();else{const{containerEl:t,cb:o,observer:s}=e[c];t.clientHeight&&s&&w(e,o)}}},N=se;N.install=e=>{e.directive("InfiniteScroll",N)};const ne=N,ae={class:"container"},le={class:"bread-container"},re={class:"sub-container"},ce={class:"body"},ie={__name:"index",setup(e){const t=h({}),o=z(),s=async()=>{const n=await K(o.params.id);t.value=n.result};D(()=>{s()});const l=h(!1),r=h([]),a=h({categoryId:o.params.id,page:1,pageSize:20,sortField:"publishTime"}),d=async()=>{const n=await B(a.value);console.log(n),r.value=n.result.items};D(()=>d());const i=()=>{console.log(a.value.sortField),d()},u=async()=>{console.log("加载更多"),a.value.page++;const n=await B(a.value);r.value=[...r.value,...n.result.items],n.result.items.length==0&&(l.value=!0)};return(n,b)=>{const _=Y,m=R,p=Q,E=$,T=ne;return y(),S("div",ae,[A("div",le,[f(m,{separator:">"},{default:v(()=>[f(_,{to:{path:"/"}},{default:v(()=>[I("首页")]),_:1}),f(_,{to:{path:`/category/${t.value.parentId}`}},{default:v(()=>[I(H(t.value.parentName),1)]),_:1},8,["to"]),f(_,null,{default:v(()=>[I(H(t.value.name),1)]),_:1})]),_:1})]),A("div",re,[f(E,{modelValue:a.value.sortField,"onUpdate:modelValue":b[0]||(b[0]=g=>a.value.sortField=g),onTabChange:i,"infinite-scroll-disabled":l.value},{default:v(()=>[f(p,{label:"最新商品",name:"publishTime"}),f(p,{label:"最高人气",name:"orderNum"}),f(p,{label:"评论最多",name:"evaluateNum"})]),_:1},8,["modelValue","infinite-scroll-disabled"]),G((y(),S("div",ce,[(y(!0),S(U,null,j(r.value,g=>(y(),q(J,{goods:g,key:g.id},null,8,["goods"]))),128))])),[[T,u]])])])}}},de=M(ie,[["__scopeId","data-v-88c36ce6"]]);export{de as default};
